#compdef hist
local key val

[[ -z $_HIST__OPTS || -z $_HIST__ARGS ]] && hist -s l &> /dev/null

local -a options=()
for key val in ${(kv)_HIST__OPTS}; do
  options+=( "${key}[$val]" )
done

local -a actions=()
for key val in ${(kv)_HIST__ARGS}; do
  actions+=( "$key\:'$val'" )
done

_arguments -s -A '' $options ":action:(($actions))" ':index, offset, prefix or pattern:'
